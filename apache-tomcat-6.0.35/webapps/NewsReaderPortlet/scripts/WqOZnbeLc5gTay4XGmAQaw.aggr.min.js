var news=news||{};if(!news.init){news.init=function(d,b){var a=function(e){d.each(e.model.feeds,function(f,g){if(g.id==e.model.activeFeed){d(".tabs",e.locate("feedListContainer")).tabs("option","selected",f);return false;}});};var c=function(e,f){e.model=f;e.model.feedIds=[];e.model.feedNames=[];d(e.model.feeds).each(function(g,h){e.model.feedIds.push(String(h.id));e.model.feedNames.push(h.name);});e.model.activeFeedStr=String(e.model.activeFeed);};b.defaults("news.reader",{url:null,gradeNames:["fluid.viewComponent","autoInit"],selectors:{feedListContainer:".news-feeds-container",storyListContainer:".news-stories-container",storyDetailContainer:".story-container"},useFlyouts:true,events:{onReady:null,onFeedReturn:null,onFeedSelect:null,onStorySelect:null},components:{feedListView:{type:"news.feedListView",createOnEvent:"onReady",container:"{reader}.dom.feedListContainer",options:{model:"{reader}.model",url:"{reader}.options.url",events:{onFeedSelect:"{reader}.events.onFeedSelect",onFeedReturn:"{reader}.events.onFeedReturn"}}},feedDetailView:{type:"news.feedDetailView",createOnEvent:"onReady",container:"{reader}.dom.storyListContainer",options:{model:"{reader}.model",useFlyouts:"{reader}.options.useFlyouts",events:{onFeedSelect:"{reader}.events.onFeedSelect",onFeedReturn:"{reader}.events.onFeedReturn",onStorySelect:"{reader}.events.onStorySelect"}}},storyDetailView:{type:"news.storyDetailView",createOnEvent:"onReady",container:"{reader}.dom.storyDetailContainer",options:{model:"{reader}.model",events:{onStorySelect:"{reader}.events.onStorySelect"}}}},finalInitFunction:function(e){d.get(e.options.url,function(g){c(e,g);e.events.onReady.fire();e.locate("feedListContainer").show();var f=0;d.each(e.model.feeds,function(h,i){if(i.id==e.model.activeFeed){f=h;return false;}});d(".tabs",e.locate("feedListContainer")).tabs({selected:f,select:function(j,l){var h,k,i;h=l.index;i=e.model.feeds[h].id;d(".news-stories-container").empty();d.ajax({url:e.options.url,data:{activeateNews:i},dataType:"json",success:function(m){e.model=m;e.events.onFeedSelect.fire(e.model.feed);a(e);},error:function(){a(e);}});}});},"json");}});b.defaults("news.feedListView",{gradeNames:["fluid.rendererComponent","autoInit"],renderOnInit:true,selectors:{feed:".news-feed",feedLink:".news-feed-link",feedName:".news-feed-name"},listeners:{hideFeed:function(e){e.hideList();},showFeed:function(e){e.showList();}},events:{onFeedSelect:null,onFeedReturn:null,showFeed:{event:"onFeedReturn",args:["{feedListView}"]},hideFeed:null},repeatingSelectors:["feed"],protoTree:{expander:{type:"fluid.renderer.repeat",repeatID:"feed",controlledBy:"feeds",pathAs:"feed",tree:{feedName:{value:"${{feed}.name}"},feedLink:{target:"javascript:;"}}}},finalInitFunction:function(e){e.hideList=function(){d(e.container).hide();};e.showList=function(){d(e.container).show();};}});b.defaults("news.feedDetailView",{gradeNames:["fluid.rendererComponent","autoInit"],renderOnInit:false,selectors:{feedTitle:".news-feed-title",backLink:".news-reader-back-link",story:".news-story",storyLink:".news-story-link",storyTitle:".news-story-title",storySummary:".news-story-summary"},events:{onFeedSelect:null,onFeedReturn:null,onStoryReturn:null,showDetails:{event:"onFeedSelect",args:["{feedDetailView}","{arguments}.0"]},hideDetails:{event:"onFeedReturn",args:["{feedDetailView}"]}},listeners:{showDetails:function(e,f){e.showDetails(f);},hideDetails:function(e){e.hideDetails();}},repeatingSelectors:["story"],protoTree:{feedTitle:{value:"${feed.title}"},backLink:{target:"javascript:;"},expander:{type:"fluid.renderer.repeat",repeatID:"story",controlledBy:"feed.entries",pathAs:"story",valueAs:"storyValue",tree:{storyTitle:{markup:"${{story}.title}"},storyLink:{target:"${{story}.link}",decorators:[{attrs:{title:"{storyValue}.description"}}]},storySummary:{markup:"${{story}.description}"}}}},finalInitFunction:function(e){d(e.options.selectors.storyLink).live("click",function(){var g,f;g=d(this).index(e.options.selectors.feedLink);f=e.model.entries[g];e.events.onStorySelect.fire(f);});e.showDetails=function(f){e.model.feed=f;e.refreshView();if(e.options.useFlyouts){d(e.options.selectors.storyLink).tooltip({showURL:false,position:{offset:"15 15"}});}d(e.container).show();};e.hideDetails=function(){d(e.container).hide();};d(e.options.selectors.backLink).live("click",function(){e.events.onFeedReturn.fire();});e.showDetails(e.model.feed);}});b.defaults("news.storyDetailView",{gradeNames:["fluid.rendererComponent","autoInit"],renderOnInit:true,selectors:{storyContent:".story-content"},events:{onStorySelect:null,onStoryReturn:null,showStory:{event:"onStorySelect",args:["{storyDetailView}","{arguments}.0"]},hideStory:{event:"onStoryReturn",args:["{storyDetailView}"]}},listeners:{showStory:function(e,f){e.showStory(f);},hideStory:function(e){e.hideStory();}},repeatingSelectors:["story"],protoTree:{expander:{type:"fluid.renderer.repeat",repeatID:"story",controlledBy:"entries",pathAs:"story",tree:{storyContent:{markup:"${{story}.description}"}}}},finalInitFunction:function(e){e.showStory=function(f){d(e.container).show();};e.hideStory=function(){d(e.container).hide();};d(e.options.selectors.backLink).live("click",function(){e.events.onStoryReturn.fire();});}});};}