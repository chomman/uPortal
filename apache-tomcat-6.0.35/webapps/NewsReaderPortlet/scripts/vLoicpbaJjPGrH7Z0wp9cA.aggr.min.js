var upnews=upnews||{};if(!upnews.init){upnews.init=function(b,a,c){upnews.NewsView=c.View.extend({onload:function(){},setup:function(){var d=this;b.ajax({url:d.url,dataType:"json",type:"POST",success:function(g){var f=new upnews.NewsFeedList();b(g.feeds).each(function(i,j){f.add(new upnews.NewsFeed(j));});d.storyContainers={};b(g.feeds).each(function(i,k){var j=new d.feedDetailViewFn();j.$el.attr("id",d.namespace+"feed"+k.id).addClass("news-stories-container");b(".view-news").append(j.$el);d.storyContainers["feed"+k.id]=j;});var h=new upnews.NewsStoryList();b(g.feed.entries).each(function(i,j){h.add(new upnews.NewsStory(j));});g.feed.stories=h;g.feed.id=g.activeFeed;d.feedDetails=new upnews.NewsFeedDetails(g.feed);d.feedListView.model=f;d.feedListView.render();var e=d.storyContainers["feed"+g.feed.id];e.model=d.feedDetails;e.populated=true;e.render();if(d.onSuccessfulSetup){d.onSuccessfulSetup();}}});},getFeed:function(f){var d,e;d=this;if(!d.storyContainers["feed"+f].populated){e={activeateNews:f};b.ajax({url:d.url,dataType:"json",data:e,type:"POST",success:function(h){var i=new upnews.NewsStoryList();b(h.feed.entries).each(function(j,k){i.add(new upnews.NewsStory(k));});h.feed.stories=i;h.feed.id=h.activeFeed;var g=d.storyContainers["feed"+h.activeFeed];g.model=new upnews.NewsFeedDetails(h.feed);g.populated=true;g.render();if(d.onSuccessfulRetrieval){d.onSuccessfulRetrieval();}}});}}});upnews.NewsFeedList=c.Collection.extend({model:upnews.NewsFeed});upnews.NewsFeed=c.Model.extend({defaults:function(){return{id:null,name:null};}});upnews.NewsFeedDetails=c.Model.extend({defaults:function(){return{stories:new upnews.NewsStoryList(),title:"Feed Title",id:0};}});upnews.NewsStoryList=c.Collection.extend({model:upnews.NewsStory});upnews.NewsStory=c.Model.extend({defaults:function(){return{content:null,description:null,link:null,title:null,uri:null,authors:[],imageUrl:null,videoUrl:null};}});upnews.NewsFeedDetailView=c.View.extend({tagName:"div",postRender:function(){},render:function(){this.$el.html(this.template(this.model.toJSON()));var d=this;this.$(".titlebar a").click(function(){d.trigger("showList");});this.postRender();return this;}});upnews.NewsFeedListView=c.View.extend({postRender:function(){},render:function(){this.$el.html(this.template({feeds:this.model.toJSON()}));this.postRender();return this;}});};}